{"ast":null,"code":"import * as L from 'leaflet';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/websocket.service\";\nexport class MapComponent {\n  constructor(websocket) {\n    this.websocket = websocket;\n    this.markerMoving = false;\n    this.number = '';\n    this.trail = [];\n    this.focusToggled = false;\n  }\n  ngAfterViewInit() {\n    this.websocket.getNumber().subscribe(num => {\n      this.number = num;\n    });\n    this.initMap();\n  }\n  initMap() {\n    this.map = L.map('map').setView([51.505, -0.09], 18);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19\n    }).addTo(this.map);\n    this.pos1 = L.circleMarker([51.5, -0.09], {\n      color: 'blue',\n      fillColor: 'blue',\n      fillOpacity: 1,\n      radius: 10\n    }).addTo(this.map).on('click', () => {\n      this.focusToggled = true;\n    }).bindPopup(\"Pos 1\");\n    var display = \"Pos 1, Lng:\" + this.pos1.lng + \" Lat: \" + this.pos1.lat;\n    this.pos1.openPopup();\n    this.trailPolyline = L.polyline([], {\n      color: 'gray',\n      weight: 4,\n      opacity: 0.8,\n      lineJoin: 'round',\n      dashArray: '5, 10'\n    });\n    this.trailPolyline.addTo(this.map);\n    setInterval(() => {\n      if (this.markerMoving) {\n        const currentLatLng = this.pos1.getLatLng();\n        this.pos1.setLatLng([currentLatLng.lat + 0.00001, currentLatLng.lng]);\n        this.trail.push([currentLatLng.lat + 0.00001, currentLatLng.lng]);\n        if (this.trail.length > 40000) {\n          this.trail.shift();\n        }\n        this.trailPolyline.setLatLngs(this.trail);\n        this.pos1.bringToFront();\n        if (this.focusToggled) this.map.setView([currentLatLng.lat, currentLatLng.lng]);\n      }\n    }, 100);\n  }\n  toggleMarkerMovement() {\n    this.markerMoving = !this.markerMoving;\n    this.focusToggled = false;\n  }\n  ngOnDestroy() {\n    this.map.remove();\n  }\n  static #_ = this.ɵfac = function MapComponent_Factory(t) {\n    return new (t || MapComponent)(i0.ɵɵdirectiveInject(i1.WebsocketService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MapComponent,\n    selectors: [[\"app-map\"]],\n    decls: 7,\n    vars: 1,\n    consts: [[1, \"map-container\"], [3, \"click\"], [1, \"map-frame\"], [\"id\", \"map\"]],\n    template: function MapComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\");\n        i0.ɵɵtext(2);\n        i0.ɵɵelementStart(3, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function MapComponent_Template_button_click_3_listener() {\n          return ctx.toggleMarkerMovement();\n        });\n        i0.ɵɵtext(4, \"Move\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"div\", 2);\n        i0.ɵɵelement(6, \"div\", 3);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Number from flask: \", ctx.number, \" \");\n      }\n    },\n    styles: [\".map-container[_ngcontent-%COMP%] {\\n    position: absolute;\\n    top: 0;\\n    left: 0;\\n    right: 0;\\n    bottom: 0;\\n    margin: 30px;\\n}\\n\\n.map-frame[_ngcontent-%COMP%] {\\nborder: 2px solid black;\\nheight: 100%;\\nborder: 1px solid #ddd;\\nborder-radius: 8px;\\noverflow: hidden;\\nbox-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);\\n}\\n\\n#map[_ngcontent-%COMP%] {\\nheight: 100%;\\n}\\n\\n.map-info[_ngcontent-%COMP%] {\\nmargin-top: 10px;\\nfont-size: 16px;\\nfont-weight: bold;\\n}\\n\\n\\n\\n.leaflet-popup-content-wrapper[_ngcontent-%COMP%] {\\nbackground: #fff;\\nborder-radius: 8px;\\nbox-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);\\n}\\n\\n.leaflet-popup-content[_ngcontent-%COMP%] {\\npadding: 10px;\\n}\\n\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbWFwL21hcC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksa0JBQWtCO0lBQ2xCLE1BQU07SUFDTixPQUFPO0lBQ1AsUUFBUTtJQUNSLFNBQVM7SUFDVCxZQUFZO0FBQ2hCOztBQUVBO0FBQ0EsdUJBQXVCO0FBQ3ZCLFlBQVk7QUFDWixzQkFBc0I7QUFDdEIsa0JBQWtCO0FBQ2xCLGdCQUFnQjtBQUNoQiwyQ0FBMkM7QUFDM0M7O0FBRUE7QUFDQSxZQUFZO0FBQ1o7O0FBRUE7QUFDQSxnQkFBZ0I7QUFDaEIsZUFBZTtBQUNmLGlCQUFpQjtBQUNqQjs7QUFFQSwwQ0FBMEM7QUFDMUM7QUFDQSxnQkFBZ0I7QUFDaEIsa0JBQWtCO0FBQ2xCLDJDQUEyQztBQUMzQzs7QUFFQTtBQUNBLGFBQWE7QUFDYiIsInNvdXJjZXNDb250ZW50IjpbIi5tYXAtY29udGFpbmVyIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgcmlnaHQ6IDA7XG4gICAgYm90dG9tOiAwO1xuICAgIG1hcmdpbjogMzBweDtcbn1cblxuLm1hcC1mcmFtZSB7XG5ib3JkZXI6IDJweCBzb2xpZCBibGFjaztcbmhlaWdodDogMTAwJTtcbmJvcmRlcjogMXB4IHNvbGlkICNkZGQ7XG5ib3JkZXItcmFkaXVzOiA4cHg7XG5vdmVyZmxvdzogaGlkZGVuO1xuYm94LXNoYWRvdzogMHB4IDBweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbn1cblxuI21hcCB7XG5oZWlnaHQ6IDEwMCU7XG59XG5cbi5tYXAtaW5mbyB7XG5tYXJnaW4tdG9wOiAxMHB4O1xuZm9udC1zaXplOiAxNnB4O1xuZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbi8qIE9wdGlvbmFsOiBTdHlsZSBmb3IgdGhlIG1hcmtlciBwb3B1cHMgKi9cbi5sZWFmbGV0LXBvcHVwLWNvbnRlbnQtd3JhcHBlciB7XG5iYWNrZ3JvdW5kOiAjZmZmO1xuYm9yZGVyLXJhZGl1czogOHB4O1xuYm94LXNoYWRvdzogMHB4IDBweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4yKTtcbn1cblxuLmxlYWZsZXQtcG9wdXAtY29udGVudCB7XG5wYWRkaW5nOiAxMHB4O1xufVxuXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"names":["L","MapComponent","constructor","websocket","markerMoving","number","trail","focusToggled","ngAfterViewInit","getNumber","subscribe","num","initMap","map","setView","tileLayer","attribution","maxZoom","addTo","pos1","circleMarker","color","fillColor","fillOpacity","radius","on","bindPopup","display","lng","lat","openPopup","trailPolyline","polyline","weight","opacity","lineJoin","dashArray","setInterval","currentLatLng","getLatLng","setLatLng","push","length","shift","setLatLngs","bringToFront","toggleMarkerMovement","ngOnDestroy","remove","_","i0","ɵɵdirectiveInject","i1","WebsocketService","_2","selectors","decls","vars","consts","template","MapComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵlistener","MapComponent_Template_button_click_3_listener","ɵɵelementEnd","ɵɵelement","ɵɵadvance","ɵɵtextInterpolate1"],"sources":["/home/cytech/Documents/Informatique/micro_services/projet/KafkaTrackingGPS/trackingGPSfront/src/app/map/map.component.ts","/home/cytech/Documents/Informatique/micro_services/projet/KafkaTrackingGPS/trackingGPSfront/src/app/map/map.component.html"],"sourcesContent":["import { Component, AfterViewInit } from '@angular/core';\nimport * as L from 'leaflet';\nimport { WebsocketService } from '../service/websocket.service';\n\n@Component({\n  selector: 'app-map',\n  templateUrl: './map.component.html',\n  styleUrls: ['./map.component.css']\n})\nexport class MapComponent implements AfterViewInit {\n  private map: any;\n  private markerMoving: boolean = false;\n  public number: string = '';\n  private pos1: any;\n  private trail: any[] = [];\n  private trailPolyline : any;\n  private focusToggled: boolean = false;\n\n  constructor(private websocket: WebsocketService) {}\n\n  ngAfterViewInit(): void {\n    this.websocket.getNumber().subscribe((num: string) => {\n      this.number = num;\n    });\n    this.initMap();\n  }\n\n  initMap(): void {\n    this.map = L.map('map').setView([51.505, -0.09], 18);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19\n    }).addTo(this.map);\n  \n    this.pos1 = L.circleMarker([51.5, -0.09], {\n      color: 'blue',\n      fillColor: 'blue',\n      fillOpacity: 1,\n      radius: 10,\n    }).addTo(this.map).on('click', ( () => {\n      this.focusToggled = true\n    })\n    ).bindPopup(\"Pos 1\");\n\n    var display: string = \"Pos 1, Lng:\"+this.pos1.lng+\" Lat: \"+this.pos1.lat;\n    this.pos1.openPopup();\n\n    this.trailPolyline = L.polyline([], {\n      color: 'gray',\n      weight: 4,\n      opacity: 0.8,\n      lineJoin: 'round',\n      dashArray: '5, 10',\n    });\n  \n    this.trailPolyline.addTo(this.map);\n  \n    setInterval(() => {\n      if (this.markerMoving) {\n        const currentLatLng = this.pos1.getLatLng();\n        this.pos1.setLatLng([currentLatLng.lat + 0.00001, currentLatLng.lng]);\n    \n        this.trail.push([currentLatLng.lat + 0.00001, currentLatLng.lng]);\n        if (this.trail.length > 40000) {\n          this.trail.shift();\n        }    \n        this.trailPolyline.setLatLngs(this.trail);\n        \n        this.pos1.bringToFront();\n        \n        if (this.focusToggled)\n          this.map.setView([currentLatLng.lat, currentLatLng.lng]);\n      }\n    }, 100);\n  }\n  \n\n  toggleMarkerMovement(): void {\n    this.markerMoving = !this.markerMoving;\n    this.focusToggled = false;\n  }\n\n  ngOnDestroy() {\n    this.map.remove();\n  }\n\n  \n}\n","<div class=\"map-container\">\n    <div>Number from flask: {{number}}\n      <button (click)=\"toggleMarkerMovement()\">Move</button>\n    </div>\n    <div class=\"map-frame\">\n      <div id=\"map\"></div>\n    </div>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}